/**
 * ═══════════════════════════════════════════════════════════════════════════
 * HIDDEN CLUE DEMO MISSION
 * Демо-миссия с системой скрытых улик для Times Square
 * ═══════════════════════════════════════════════════════════════════════════
 */

import type { HiddenClue, HiddenClueMission } from "@/types/hidden-clue";

// ═══════════════════════════════════════════════════════════════════════════
// ВАЖНО: Как работает система panoId
// ═══════════════════════════════════════════════════════════════════════════
// 
// Поскольку мы не знаем заранее panoId всех панорам, используем
// специальные значения:
//
// - "START" — стартовая панорама
// - "STEP_1" — любая панорама после 1 перехода от старта
// - "STEP_2" — после 2 переходов
// - "STEP_3+" — после 3+ переходов (переулки)
// - "ANY" — любая панорама (для финальных улик)
//
// Система отслеживает количество переходов и подставляет реальный panoId
// ═══════════════════════════════════════════════════════════════════════════

export const TIMES_SQUARE_CLUES: HiddenClue[] = [
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 1: Записка на ступеньках TKTS
  // Находится прямо на старте, но нужно посмотреть вверх-вправо
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_note",
    panoId: "START", // На стартовой панораме
    revealHeading: 25, // Чуть правее центра
    coneDegrees: 60,
    dwellTime: 1.2,
    
    name: "Записка на ступеньках",
    description: "Смятый клочок бумаги с адресом",
    icon: "📝",
    storyContext: "Записка гласит: 'Marriott Marquis, комната 1847. Не опаздывай.' Почерк нервный — свидетель торопился.",
    xpReward: 30,
    
    hintText: "Что-то белеет на красных ступеньках...",
    scannerHint: "Сканер фиксирует бумажный объект на площади.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 2: Камера наблюдения M&M's
  // После 1 перехода влево, смотреть вверх
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_camera",
    panoId: "STEP_1", // После 1 перехода
    revealHeading: 280, // Влево и вверх
    coneDegrees: 50,
    dwellTime: 1.5,
    
    name: "Камера магазина",
    description: "Камера видеонаблюдения на углу здания",
    icon: "📹",
    storyContext: "Камера направлена на площадь. Запись можно запросить — но магазин откроется только в 10:00. У нас мало времени.",
    xpReward: 40,
    
    hintText: "Красный огонёк мигает на здании...",
    scannerHint: "Обнаружено электронное устройство поблизости.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 3: Визитка в переулке
  // После 2 переходов (свернул с главной), на земле
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_card",
    panoId: "STEP_2",
    revealHeading: 160, // Назад и вниз
    coneDegrees: 70,
    dwellTime: 1.0,
    
    name: "Визитная карточка",
    description: "Визитка адвокатской конторы",
    icon: "💼",
    storyContext: "'Morrison & Black, Corporate Law.' На обороте от руки: 'Они следят. Доверяй только Саре.' Кто такая Сара?",
    xpReward: 35,
    
    hintText: "Что-то лежит на асфальте...",
    scannerHint: "Сканер обнаружил объект в этом районе.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 4: Разбитый телефон
  // Глубоко в переулке (3+ шага), нужно наклониться вниз
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_phone",
    panoId: "STEP_3+",
    revealHeading: 90, // Вправо, у стены
    coneDegrees: 45, // Узкий конус — сложнее найти
    dwellTime: 1.8,
    
    name: "Разбитый смартфон",
    description: "Телефон с треснувшим экраном",
    icon: "📱",
    storyContext: "Экран разбит, но SIM-карта на месте. Последний звонок: +1-212-555-0147. Это номер такси-сервиса.",
    xpReward: 50,
    
    hintText: "Стекло хрустит под ногами...",
    scannerHint: "Электронное устройство обнаружено в переулке.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 5: Следы шин
  // В тупике переулка, на земле
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_tires",
    panoId: "STEP_3+",
    revealHeading: 220, // Влево-назад
    coneDegrees: 80,
    dwellTime: 1.2,
    
    name: "Следы резкого старта",
    description: "Чёрные полосы от шин на асфальте",
    icon: "🚗",
    storyContext: "Рисунок протектора характерный — это Michelin Pilot Sport. Такие ставят на дорогие седаны. Lincoln или Cadillac.",
    xpReward: 45,
    
    hintText: "На асфальте странные следы...",
    scannerHint: "Обнаружены следы транспортного средства.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 6: Оторванная пуговица
  // Очень сложная — маленький конус, долгий dwell
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_button",
    panoId: "STEP_2",
    revealHeading: 45, // Справа, низко
    coneDegrees: 40, // Узкий!
    dwellTime: 2.0, // Долго!
    
    name: "Пуговица от пальто",
    description: "Золотистая пуговица с гербом",
    icon: "🔘",
    storyContext: "Пуговица от дорогого пальто. Герб — это логотип ателье 'Brioni'. Такое пальто стоит $5000+. Наш свидетель не бедствовал.",
    xpReward: 55,
    
    hintText: "Что-то блестит у стены...",
    scannerHint: "Сканер зафиксировал металлический объект.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 7: Билет в театр
  // Можно найти везде, но редко
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_ticket",
    panoId: "ANY",
    revealHeading: 330, // Влево-вверх
    coneDegrees: 55,
    dwellTime: 1.3,
    
    name: "Билет на мюзикл",
    description: "Билет на 'Hamilton' на сегодня",
    icon: "🎭",
    storyContext: "Билет на 20:00, место A-12. VIP-ложа. Свидетель планировал вернуться сюда после встречи... живым.",
    xpReward: 40,
    
    hintText: "Ветер несёт какую-то бумажку...",
    scannerHint: "Объект органического происхождения поблизости.",
  },
  
  // ═══════════════════════════════════════════════════════════════════════════
  // УЛИКА 8: Шприц (медицинский)
  // Секретная улика — очень сложно найти
  // ═══════════════════════════════════════════════════════════════════════════
  {
    id: "clue_syringe",
    panoId: "STEP_3+",
    revealHeading: 180, // Точно назад
    coneDegrees: 35, // Очень узкий!
    dwellTime: 2.5, // Очень долго!
    
    name: "Медицинский шприц",
    description: "Использованный шприц с остатками вещества",
    icon: "💉",
    storyContext: "Это не наркотик — это кетамин. Препарат для быстрой анестезии. Свидетеля усыпили и увезли. Это профессиональное похищение.",
    xpReward: 75,
    
    hintText: "Запах химии в воздухе...",
    scannerHint: "ВНИМАНИЕ: Обнаружены следы контролируемого вещества!",
  },
];

// ═══════════════════════════════════════════════════════════════════════════
// ДЕМО-МИССИЯ
// ═══════════════════════════════════════════════════════════════════════════

export const TIMES_SQUARE_HIDDEN_MISSION: HiddenClueMission = {
  id: "times_square_hidden",
  title: "Исчезновение на Таймс Сквер",
  description: "Свидетель по делу о корпоративном мошенничестве пропал без следа.",
  briefing: `
    СРОЧНО | КОНФИДЕНЦИАЛЬНО
    
    14 марта, 21:47. Свидетель Дэвид Морроу должен был 
    встретиться с агентом ФБР на Таймс Сквер.
    
    Он не появился. Телефон отключён.
    Последний сигнал — здесь.
    
    Ваша задача:
    • Осмотреть место исчезновения
    • Найти все улики
    • Восстановить картину произошедшего
    
    ВНИМАНИЕ: Улики скрыты. Осматривайте всё внимательно.
    Сворачивайте в переулки. Смотрите по сторонам.
  `,
  
  startPanoId: "START",
  startHeading: 0,
  
  clues: TIMES_SQUARE_CLUES,
  requiredClues: 5, // Нужно 5 из 8
  
  timeLimit: 600, // 10 минут
  xpReward: 500,
  
  location: "Нью-Йорк, Таймс Сквер",
  difficulty: "hard",
  icon: "🗽",
  color: "#ef4444",
};

export default TIMES_SQUARE_HIDDEN_MISSION;

