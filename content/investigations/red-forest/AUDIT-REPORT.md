# üî¥ –ö–†–ê–°–ù–´–ô –õ–ï–° ‚Äî –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç

**–î–∞—Ç–∞:** –Ø–Ω–≤–∞—Ä—å 2026  
**–í–µ—Ä—Å–∏—è Ink:** 1.1.1  
**–í–µ—Ä—Å–∏—è inkjs:** Latest

---

## üìä –†–ï–ó–Æ–ú–ï

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö | –°–µ—Ä—å—ë–∑–Ω—ã—Ö | –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö |
|-----------|-------------|-----------|----------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 2 | 1 | 0 |
| –õ–æ–≥–∏–∫–∞ | 1 | 3 | 2 |
| –ü–æ–≤–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ | 0 | 2 | 4 |
| Ink —Å–∏–Ω—Ç–∞–∫—Å–∏—Å | 0 | 1 | 2 |
| **–í—Å–µ–≥–æ** | **3** | **7** | **8** |

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —ç–ø–∏–∑–æ–¥–∞–º–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ö–∞–∂–¥—ã–π —ç–ø–∏–∑–æ–¥ –æ–±—ä—è–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å –∂—ë—Å—Ç–∫–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –í—ã–±–æ—Ä—ã –∏–≥—Ä–æ–∫–∞ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–ø–∏–∑–æ–¥–∞—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

**–ü—Ä–∏–º–µ—Ä:**
```ink
// Episode 1 –∫–æ–Ω–µ—Ü: sanity –º–æ–∂–µ—Ç –±—ã—Ç—å 60-85 –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±–æ—Ä–æ–≤
// Episode 2 —Å—Ç–∞—Ä—Ç: VAR sanity = 70 (–§–ò–ö–°–ò–†–û–í–ê–ù–ù–û–ï –∑–Ω–∞—á–µ–Ω–∏–µ)
```

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî **—Ñ–∏–∫—Ç–∏–≤–Ω–∞—è**
- –ò–≥—Ä–æ–∫ –Ω–µ –≤–∏–¥–∏—Ç –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π —Å–≤–æ–∏—Ö —Ä–µ—à–µ–Ω–∏–π
- –°–∏—Å—Ç–µ–º–∞ –¥–æ–≤–µ—Ä–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω `lib/ink-state-manager.ts` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å InkStoryPlayer

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

### 2. –§–∞–π–ª `variables.ink` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`is_sane()`, `total_clues()`, `check_endings()`), –Ω–æ –Ω–∏ –æ–¥–∏–Ω —ç–ø–∏–∑–æ–¥ –Ω–µ –¥–µ–ª–∞–µ—Ç `INCLUDE variables.ink`.

**–í–ª–∏—è–Ω–∏–µ:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ –∫–∞–∂–¥–æ–º —ç–ø–∏–∑–æ–¥–µ
- –§—É–Ω–∫—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã
- –ù–∞—Ä—É—à–µ–Ω–∏–µ DRY –ø—Ä–∏–Ω—Ü–∏–ø–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω `state-manager.ink` —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–∞ LIST –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ VAR

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ

---

### 3. –õ–æ–≥–∏–∫–∞ –∫–æ–Ω—Ü–æ–≤–æ–∫ —É–±–∏–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å

**–û–ø–∏—Å–∞–Ω–∏–µ:**
```ink
// Episode 5 ‚Äî ending_branches
{ sanity < 25: -> ending_sacrifice_check }    // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1
{ trust_tanya >= 70: -> ending_escape_check }  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2
{ evidence_collected >= 10: -> ending_truth_check }  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3
-> ending_hero  // Default
```

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–ï—Å–ª–∏ `sanity < 25` –ò `trust_tanya >= 70`, –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∏—Ç –¢–û–õ–¨–ö–û "–ñ–µ—Ä—Ç–≤—É" –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞.

**–†–µ—à–µ–Ω–∏–µ:**
```ink
// –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –í–´–ë–û–† –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–Ω—Ü–æ–≤–æ–∫
{ sanity < 25 && trust_tanya >= 70:
    * [–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å —Å–æ–±–æ–π] -> ending_sacrifice
    * [–ë–µ–∂–∞—Ç—å —Å –¢–∞–Ω–µ–π] -> ending_escape
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

---

## üü° –°–ï–†–¨–Å–ó–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 4. –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ñ–ª–∞–≥–æ–≤ –º–µ–∂–¥—É —ç–ø–∏–∑–æ–¥–∞–º–∏

| –§–ª–∞–≥ | Ep.1 –∫–æ–Ω–µ—Ü | Ep.2 —Å—Ç–∞—Ä—Ç | Ep.3 —Å—Ç–∞—Ä—Ç |
|------|------------|------------|------------|
| `met_serafim` | true/false | **false** | **true** |
| `witnessed_ritual` | N/A | false | **true** |
| `romantic_tanya` | N/A | false | N/A |

**–í–ª–∏—è–Ω–∏–µ:** –§–ª–∞–≥–∏ –Ω–µ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–≥—Ä–æ–∫–∞.

---

### 5. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

| –î–µ–Ω—å | –î–∞—Ç–∞ | `days_remaining` | –†–∞—Å—á—ë—Ç |
|------|------|------------------|--------|
| 1 | 15 –Ω–æ—è–±—Ä—è | 7 | OK |
| 2 | 16 –Ω–æ—è–±—Ä—è | 6 | OK |
| 3 | 17 –Ω–æ—è–±—Ä—è | 5 | OK |
| 4 | 18 –Ω–æ—è–±—Ä—è | 4 | OK |
| 5 | 19 –Ω–æ—è–±—Ä—è | 3 | **?** |

**–ü—Ä–æ–±–ª–µ–º–∞:** 7 - 5 –¥–Ω–µ–π = 2 –¥–Ω—è –æ—Å—Ç–∞–ª–æ—Å—å, –Ω–æ `days_remaining = 3`.

---

### 6. –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∂–∏–≤/–º—ë—Ä—Ç–≤ –±–µ–∑ –ª–æ–≥–∏–∫–∏

| –ü–µ—Ä—Å–æ–Ω–∞–∂ | –≠–ø–∏–∑–æ–¥ 4 | –≠–ø–∏–∑–æ–¥ 5 | –õ–æ–≥–∏–∫–∞ |
|----------|----------|----------|--------|
| –°–µ—Ä–∞—Ñ–∏–º | "–ó–∞–±—Ä–∞–ª–∏" | –ù–∞ –∞–ª—Ç–∞—Ä–µ | ‚ùì –ö–∞–∫ –æ–Ω —Ç—É–¥–∞ –ø–æ–ø–∞–ª? |
| –í–µ—Ä–∞ | "–ó–∞–±—Ä–∞–ª–∏" | –ù–∞ –∞–ª—Ç–∞—Ä–µ | ‚ùì –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ —Å `trusted_vera = true` |
| –ó–æ—Ä–∏–Ω | –ü—Ä–æ–ø–∞–ª 3 –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥ | –ñ–∏–≤–æ–π –Ω–∞ –∞–ª—Ç–∞—Ä–µ | ‚ùì –ì–¥–µ –æ–Ω –±—ã–ª? |

---

### 7. –ù–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è sanity

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- 15+ –º–µ—Å—Ç –°–ù–ò–ñ–ê–Æ–¢ sanity
- 0 –º–µ—Å—Ç –í–û–°–°–¢–ê–ù–ê–í–õ–ò–í–ê–Æ–¢ sanity
- –ö —ç–ø–∏–∑–æ–¥—É 5: sanity –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ < 30

**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ—á–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:**
- –†–∞–∑–≥–æ–≤–æ—Ä —Å –°–µ—Ä–∞—Ñ–∏–º–æ–º: +5
- –£—Å–ø–µ—Ö –≤ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏: +3
- –•–æ—Ä–æ—à–∏–π —Å–æ–Ω: +5
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¢–∞–Ω–∏: +3

---

## üîµ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LIST –¥–ª—è —É–ª–∏–∫

**–¢–µ–∫—É—â–µ–µ (–ø–ª–æ—Ö–æ):**
```ink
VAR clue_missing_list = false
VAR clue_false_reports = false
VAR clue_witness_conflict = false
// ... –µ—â—ë 11 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```

**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ:**
```ink
LIST CluesA = missing_list, false_reports, witness_conflict
LIST CluesB = echo_docs, experiment_records, underground_map, access_pass
// –ü—Ä–æ–≤–µ—Ä–∫–∞: CluesA ? missing_list
// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ: CluesA += false_reports
```

---

### 2. –î–æ–±–∞–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ inkjs

```typescript
// –í InkStoryPlayer
story.bindExternalFunction("playSoundEffect", (sound: string) => {
  playSound(sound);
});

story.bindExternalFunction("triggerHaptic", (type: string) => {
  haptic.trigger(type);
});

story.bindExternalFunction("saveCheckpoint", () => {
  saveState(extractStateFromStory(story, episodeId));
});
```

---

### 3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ –¥–ª—è UI

```ink
# mood:fear
# sound:wind_howling
# haptic:heavy
–í—ã –≤—Ö–æ–¥–∏—Ç–µ –≤ –ª–µ—Å. –î–µ—Ä–µ–≤—å—è —Å–º—ã–∫–∞—é—Ç—Å—è –Ω–∞–¥ –≥–æ–ª–æ–≤–æ–π.
```

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

- [x] –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (`ink-state-manager.ts`)
- [x] –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å LIST (`state-manager.ink`)
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å state manager –≤ InkStoryPlayer
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∫–æ–Ω—Ü–æ–≤–æ–∫ (–¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä)
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–æ—á–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è sanity
- [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –ª–∏–Ω–∏—é (days_remaining)
- [x] –î–æ–±–∞–≤–∏—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å—É–¥—å–±—ã –ó–æ—Ä–∏–Ω–∞
- [x] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥–∏ –¥–ª—è UI-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- [x] –î–æ–±–∞–≤–∏—Ç—å external functions
- [x] –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é (`red-forest-complete.ink`)
- [x] –°–æ–∑–¥–∞—Ç—å React —Ö—É–∫ (`useRedForestIntegration.tsx`)
- [x] –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–µ—Ç–æ–∫ (–≤—Ä—É—á–Ω—É—é)

---

## üìà –ú–ê–¢–†–ò–¶–ê –ü–†–û–•–û–ñ–î–ï–ù–ò–Ø

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—É—Ç–∏ –∫ –∫–æ–Ω—Ü–æ–≤–∫–∞–º:

```
–≠–ü–ò–ó–û–î 1 ‚Üí –≠–ü–ò–ó–û–î 2 ‚Üí –≠–ü–ò–ó–û–î 3 ‚Üí –≠–ü–ò–ó–û–î 4 ‚Üí –≠–ü–ò–ó–û–î 5
    |           |           |           |           |
    ‚Üì           ‚Üì           ‚Üì           ‚Üì           ‚Üì
 sanity--    sanity--    sanity--    sanity--    –ö–û–ù–¶–û–í–ö–ê
 trust++     trust++     trust++     trust++
 clues++     clues++     clues++     clues++

–ö–û–ù–¶–û–í–ö–ê "–ü–†–ê–í–î–ê":     clues >= 10, sanity >= 40
–ö–û–ù–¶–û–í–ö–ê "–ì–ï–†–û–ô":      witnessed_ritual, sanity >= 40
–ö–û–ù–¶–û–í–ö–ê "–ñ–ï–†–¢–í–ê":     sanity < 30
–ö–û–ù–¶–û–í–ö–ê "–ü–ï–†–ï–†–û–ñ–î–ï–ù–ò–ï": trust_vera >= 60, trusted_vera
–ö–û–ù–¶–û–í–ö–ê "–ü–û–ë–ï–ì":      trust_tanya >= 60
```

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- inkjs: ^2.2.0
- Next.js: 16.x
- TypeScript: 5.x

### –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
```
content/investigations/red-forest/
‚îú‚îÄ‚îÄ story-bible.md          # –õ–æ—Ä –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏
‚îú‚îÄ‚îÄ state-manager.ink       # –ù–û–í–´–ô: –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îú‚îÄ‚îÄ variables.ink           # –£–°–¢–ê–†–ï–í–®–ò–ô: –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
‚îú‚îÄ‚îÄ episode-1.ink           # –≠–ø–∏–∑–æ–¥ 1
‚îú‚îÄ‚îÄ episode-2.ink           # –≠–ø–∏–∑–æ–¥ 2
‚îú‚îÄ‚îÄ episode-3.ink           # –≠–ø–∏–∑–æ–¥ 3
‚îú‚îÄ‚îÄ episode-4.ink           # –≠–ø–∏–∑–æ–¥ 4
‚îú‚îÄ‚îÄ episode-5.ink           # –≠–ø–∏–∑–æ–¥ 5
‚îú‚îÄ‚îÄ config.ts               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ AUDIT-REPORT.md         # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```typescript
// –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —ç–ø–∏–∑–æ–¥–∞
const initialState = getInitialStateForEpisode(episodeId);
const story = new Story(storyContent);
applyStateToStory(story, initialState);

// –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –≤—ã–±–æ—Ä–∞
const currentState = extractStateFromStory(story, episodeId);
saveState(currentState);

// –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —ç–ø–∏–∑–æ–¥–∞
const finalState = extractStateFromStory(story, episodeId);
saveState(finalState);
// ‚Üí –¢–µ–ø–µ—Ä—å —Å–ª–µ–¥—É—é—â–∏–π —ç–ø–∏–∑–æ–¥ –∑–∞–≥—Ä—É–∑–∏—Ç —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```

---

**–ê—É–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω:** Claude (Opus 4.5)  
**–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è:** Ink Best Practices 2025, inkjs Documentation, Detective Game Patterns
