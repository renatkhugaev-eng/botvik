/**
 * Guided Tour Steps Configuration
 * Полный брутальный онбординг для BOTVIK
 */

export type TourStep = {
  id: string;
  target: string; // CSS selector или data-tour attribute
  title: string;
  content: string;
  position: 'top' | 'bottom' | 'left' | 'right' | 'center';
  spotlight?: boolean; // Подсвечивать элемент
};

export const TOUR_STEPS: TourStep[] = [
  // ═══════════════════════════════════════════════════════════════
  // ПРИВЕТСТВИЕ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'welcome',
    target: '[data-tour="welcome"]',
    title: '🩸 TRUE КРОВЬ',
    content: `Добро пожаловать, детектив.

TRUE КРОВЬ — официальное приложение телеграм-канала «Чернила и Кровь».

Здесь ты проверяешь свои знания о самых жутких преступлениях в истории. Серийные убийцы, маньяки, культы, нераскрытые дела.

Нет места слабакам. Докапывайся до правды или оставайся в неведении.

Сейчас покажу как тут всё устроено.`,
    position: 'center',
    spotlight: false,
  },

  // ═══════════════════════════════════════════════════════════════
  // ПРОФИЛЬ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'avatar',
    target: '[data-tour="avatar"]',
    title: '👤 Твой профиль',
    content: `Нажми на аватар — попадёшь в личный кабинет.

ЧТО ТАМ ЕСТЬ:
• Статистика всех игр
• Достижения и бейджи
• Уровень и XP прогресс
• Друзья и заявки
• Инвентарь (рамки, скины)
• История дуэлей
• Настройки уведомлений

Прокачивайся или оставайся никем.`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ЭНЕРГИЯ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'energy',
    target: '[data-tour="energy"]',
    title: '⚡ Энергия — без неё никуда',
    content: `Энергия нужна для игры в квизы.

ПРАВИЛА:
• 1 квиз = 1 энергия
• Максимум: 5 единиц
• Восстановление: +1 каждые 4 часа
• Полное восстановление: 20 часов

КАК ПОЛУЧИТЬ БОЛЬШЕ:
• Ежедневные награды дают бонусную энергию
• Бонусная энергия (+) показывается отдельно
• Сначала тратится обычная, потом бонусная

Кончилась энергия — жди или приходи позже.`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ОЧКИ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'score',
    target: '[data-tour="score"]',
    title: '💎 Очки — твоя репутация',
    content: `Очки определяют твою позицию в рейтинге.

КАК ЗАРАБОТАТЬ:
• Базовые: 100 очков за правильный ответ
• Бонус за скорость: до +50 очков
• Бонус за стрик: до +50 очков
• Множитель сложности: x1.5 или x2

ШТРАФЫ:
• Неправильный ответ: -15 очков
• Время вышло: 0 очков за вопрос

Чем больше очков — тем выше в таблице лидеров.`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // КВИЗЫ — ОСНОВНАЯ МЕХАНИКА
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'quizzes',
    target: '[data-tour="quizzes"]',
    title: '🎯 Квизы — главный режим',
    content: `Выбираешь тему → отвечаешь на вопросы → получаешь очки.

ТЕМЫ:
• Серийные убийцы
• Культы и секты
• Маньяки и психопаты
• Нераскрытые дела
• Последние слова перед казнью

ВРЕМЯ:
• 15 секунд на каждый вопрос
• Чем быстрее ответил — тем больше очков
• Ответ за 1-2 сек = максимальный бонус`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // КВИЗЫ — СТРИКИ И ПОПЫТКИ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'quizzes-mechanics',
    target: '[data-tour="quizzes"]',
    title: '🔥 Стрики и попытки',
    content: `СТРИК (серия правильных):
• 2 подряд: +20 бонус
• 3 подряд: +30 бонус
• 5 подряд: +50 бонус (максимум)
• Ошибся = стрик сбросился

ПОПЫТКИ (повторное прохождение):
• 1-я попытка: 100% очков
• 2-я попытка: 70% очков
• 3-я попытка: 50% очков
• 4-я попытка: 35% очков
• 5+ попытка: 25% очков

Играй разные квизы — не гринди один!`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ЛИДЕРБОРД
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'leaderboard',
    target: '[data-tour="leaderboard"]',
    title: '🏆 Еженедельный турнир',
    content: `Каждую неделю — новое соревнование с реальными призами!

ПРИЗЫ:
🥇 1 место — 1000₽
🥈 2 место — 500₽
🥉 3 место — 250₽

ПРАВИЛА:
• Старт: понедельник 00:00 МСК
• Финиш: воскресенье 23:59 МСК
• Счёт = сумма лучших по ВСЕМ квизам
• Минимум 3 участника для розыгрыша
• Нужна подписка на канал

Выплаты на карту в течение 24 часов.`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ДУЭЛИ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'duels',
    target: '[data-tour="duels"]',
    title: '⚔️ Дуэли — 1 на 1',
    content: `Вызови друга или случайного игрока на батл!

КАК РАБОТАЕТ:
• Оба отвечаете на одинаковые вопросы
• У каждого своё время (15 сек)
• Кто набрал больше очков — победил
• Ничья если очки равны

СТАТИСТИКА:
• Побед / Поражений / Ничьих
• Винрейт в процентах
• Текущая серия побед
• Лучшая серия побед

Проигрыш не страшен — это опыт.`,
    position: 'top',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ПАНОРАМЫ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'panorama',
    target: '[data-tour="panorama"]',
    title: '🗺️ Панорамы — места преступлений',
    content: `Исследуй реальные локации в 360° и ищи улики!

УПРАВЛЕНИЕ:
• Тяни мышкой/пальцем чтобы крутить
• Стрелки для перемещения
• Миникарта показывает позицию

ПОДСКАЗКИ (Рентген):
• 7 использований за миссию
• Показывает направление к улике
• Красная точка = улика рядом

ЦЕЛЬ:
• Найди все скрытые улики
• Уложись в отведённое время
• Чем быстрее — тем больше очков`,
    position: 'top',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ЕЖЕДНЕВНЫЕ НАГРАДЫ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'daily-reward',
    target: '[data-tour="daily-reward"]',
    title: '🎁 Ежедневные награды',
    content: `Заходи каждый день и получай бонусы!

НАГРАДЫ ПО ДНЯМ:
• День 1: +10 XP
• День 2: +20 XP
• День 3: +30 XP
• День 4: +40 XP
• День 5: +50 XP
• День 6: +75 XP
• День 7: +100 XP + бонусная энергия!

СТРИК:
• Заходи каждый день подряд
• Пропустил = стрик сбросился
• Начинаешь с дня 1 заново

Дисциплина = халява.`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // XP И УРОВНИ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'xp-system',
    target: '[data-tour="avatar"]',
    title: '⭐ XP и уровни',
    content: `XP (опыт) нужен для прокачки уровня.

КАК ПОЛУЧИТЬ XP:
• Завершить квиз: +50 XP
• За каждый правильный ответ: +10 XP
• Идеальный квиз (100%): +100 XP бонус
• Первый квиз дня: +30 XP бонус
• Стрик 5+: +25 XP
• Стрик 10+: +50 XP

УРОВНИ:
🌱 1-4: Новичок
🎯 5-9: Следопыт
🔍 10-19: Детектив
🔮 20-34: Инспектор
🕵️ 35-49: Профайлер
⚡ 50-99: Мастер
👑 100+: Легенда`,
    position: 'bottom',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // НАВИГАЦИЯ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'navigation',
    target: '[data-tour="navigation"]',
    title: '🛒 Магазин и Чат',
    content: `Две кнопки внизу экрана:

МАГАЗИН 🛍️
• Рамки для аватара
• Эксклюзивные скины
• Покупай за монеты или реал
• Выделяйся среди других

ЧАТ 💬
• Общий чат сообщества
• Ищи друзей и соперников
• Обсуждай дела и квизы
• Делись рекордами
• Нажми на юзера → профиль

Токсичность в меру приветствуется.`,
    position: 'top',
    spotlight: true,
  },

  // ═══════════════════════════════════════════════════════════════
  // ФИНАЛ
  // ═══════════════════════════════════════════════════════════════
  {
    id: 'finish',
    target: '[data-tour="finish"]',
    title: '🩸 Ты готов, детектив.',
    content: `ЗАПОМНИ ГЛАВНОЕ:

⚡ Энергия: 5 макс, +1 каждые 4 часа
🎯 Квизы: 15 сек на ответ, стрики = бонусы
🏆 Лидерборд: сумма лучших, призы в воскресенье
⚔️ Дуэли: батлы с друзьями
🗺️ Панорамы: ищи улики в 360°
🎁 Daily: заходи каждый день

СОВЕТЫ:
• Играй разные квизы — больше очков
• Отвечай быстро — время = очки
• Держи стрик — бонусы за серию
• Подпишись на «Чернила и Кровь»

Удачи не будет — только скилл. Погнали!`,
    position: 'center',
    spotlight: false,
  },
];

// Ключ для localStorage
export const TOUR_STORAGE_KEY = 'botvik_tour_completed';

// Проверка прошёл ли пользователь туториал
export function isTourCompleted(): boolean {
  if (typeof window === 'undefined') return true;
  return localStorage.getItem(TOUR_STORAGE_KEY) === 'true';
}

// Отметить туториал как пройденный
export function markTourCompleted(): void {
  if (typeof window === 'undefined') return;
  localStorage.setItem(TOUR_STORAGE_KEY, 'true');
}

// Сбросить туториал (для повторного прохождения)
export function resetTour(): void {
  if (typeof window === 'undefined') return;
  localStorage.removeItem(TOUR_STORAGE_KEY);
}
